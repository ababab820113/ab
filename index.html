<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AB測驗</title>
  <style>
    :root {
      /* 手機上手指比較粗，安全距離稍微加大；JS 也會再依裝置微調 */
      --safe-distance: 48px;
      --runaway-speed: 22px;
    }

    /* 置中 + 手機寬度友善 */
    body {
      margin: 0;
      min-height: 100svh;
      display: grid;
      place-items: center;
      background: #faf7f5;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", Arial, sans-serif;
    }

    .option-group {
      border: 1px solid #ccc;
      border-radius: 12px;
      padding: 20px 18px;
      width: min(92vw, 420px);
      background: #fff;
      box-shadow: 0 6px 20px rgba(0, 0, 0, .06);
      overflow: hidden;
      /* 讓逃跑別超出容器太多 */
    }

    .title {
      font-weight: 700;
      font-size: clamp(18px, 4vw, 22px);
      margin-bottom: 14px;
      line-height: 1.3;
    }

    .option {
      display: flex;
      align-items: center;
      position: relative;
      min-height: 40px;
      /* 手機觸控友善 */
      margin: 10px 0;
    }

    .option input[type="radio"] {
      width: 24px;
      height: 24px;
      position: absolute;
      left: 0;
      transition: transform .25s ease;
      /* 逃跑時比較順 */
      touch-action: none;
      /* 讓 pointermove 更穩定 */
    }

    .option span {
      margin-left: 36px;
      /* 騰出單選鈕空間 */
      font-size: 16px;
    }

    /* 小螢幕再放大一點點點擊目標 */
    @media (max-width: 480px) {
      .option {
        min-height: 46px;
      }

      .option input[type="radio"] {
        width: 26px;
        height: 26px;
      }

      .option span {
        font-size: 17px;
      }
    }
  </style>



<script>
    // 取得包住所有選項的容器（父層）
    const box = document.getElementById('box');

    // 找到所有 class="runaway" 裡的單選按鈕 input
    const runners = Array.from(document.querySelectorAll('.runaway input[type="radio"]'));

    /* === 阻止 runaway 選項被點選（無法選中） === */

    // 取得所有 runaway 的 <label>
    const runawayLabels = Array.from(document.querySelectorAll('.runaway'));

    // 針對每個 runaway 的 label 加事件
    runawayLabels.forEach(lbl => {
      // 點擊時（不管點文字或框框）阻止事件
      lbl.addEventListener('click', e => {
        e.preventDefault();    // 阻止預設動作（避免選中）
        e.stopPropagation();   // 阻止事件傳播
      });
      // 滑鼠或手指按下去時就先擋住
      lbl.addEventListener('pointerdown', e => {
        e.preventDefault();
        e.stopPropagation();
      });
    });

    /* === 鍵盤操作也要擋住，避免用 Tab/空白鍵選中 === */
    runners.forEach(r => {
      r.setAttribute('tabindex', '-1');          // 不能用 Tab 聚焦到這個選項
      r.setAttribute('aria-disabled', 'true');   // 輔助工具會讀出「已停用」
      r.addEventListener('keydown', e => e.preventDefault()); // 阻止任何鍵盤操作
    });

    /* === 偵測滑鼠/手指移動，讓 runaway 的按鈕逃跑 === */
    // 綁定事件（支援 mouse / touch / pen）
    box.addEventListener('pointermove', handlePointer, { passive: true });
    // 如果想在點下去就逃跑，可以開啟下面這行
    // box.addEventListener('pointerdown', handlePointer, { passive: true });

    // 處理滑鼠或手指移動
    function handlePointer(e) {
      const { clientX, clientY } = e; // 目前指標座標

      runners.forEach(input => {
        const rect = input.getBoundingClientRect(); // 取得這個按鈕的位置與大小
        const cx = rect.left + rect.width / 2;      // 按鈕中心點 X
        const cy = rect.top + rect.height / 2;      // 按鈕中心點 Y

        const dx = clientX - cx;  // 指標到按鈕中心的水平距離
        const dy = clientY - cy;  // 指標到按鈕中心的垂直距離
        const dist = Math.hypot(dx, dy); // 計算直線距離

        // 如果指標距離小於一定範圍，就要逃跑
        if (dist < (window.matchMedia('(pointer: coarse)').matches ? 56 : 40)) {
          // 算出角度（指標在哪個方向靠近）
          const angle = Math.atan2(dy, dx);

          // 設定逃跑速度（手機比較大，所以跑快一點）
          const RUNAWAY_SPEED = window.matchMedia('(pointer: coarse)').matches ? 24 : 20;

          // 算出往相反方向移動的量
          let offsetX = -Math.cos(angle) * RUNAWAY_SPEED;
          let offsetY = -Math.sin(angle) * RUNAWAY_SPEED;

          // 取得目前的位移（transform: translate）
          const style = getComputedStyle(input);
          const matrix = new DOMMatrixReadOnly(style.transform);
          let currentX = matrix.m41; // 現在的 X 位移
          let currentY = matrix.m42; // 現在的 Y 位移

          // 計算下一步要移動到哪裡
          let nextX = currentX + offsetX;
          let nextY = currentY + offsetY;

          // 邊界檢查（避免跑出去 box 容器）
          const group = box.getBoundingClientRect();
          const padding = 8; // 留一點內距
          if (rect.left + offsetX < group.left + padding) 
              nextX = currentX + (group.left + padding - rect.left);
          if (rect.right + offsetX > group.right - padding) 
              nextX = currentX + (group.right - padding - rect.right);
          if (rect.top + offsetY < group.top + padding) 
              nextY = currentY + (group.top + padding - rect.top);
          if (rect.bottom + offsetY > group.bottom - padding) 
              nextY = currentY + (group.bottom - padding - rect.bottom);

          // 設定新的位移
          input.style.transform = `translate(${nextX}px, ${nextY}px)`;
        }
      });
    }
</script>


  
</head>

<body>
  <div class="option-group" id="box">
    <div class="title">在你心目中，你覺得你自己是...？</div>

    <!-- 正常可點 -->
    <label class="option">
      <input type="radio" name="drink" value="yes">
      <span>一級棒！我超愛現在的自己～</span>
    </label>

    <!-- 下面這些會逃跑 -->
    <label class="option runaway">
      <input type="radio" name="drink" value="no">
      <span>還行啦，馬馬虎虎過日子</span>
    </label>

    <label class="option runaway">
      <input type="radio" name="drink" value="onTheHouse">
      <span>普普通通，沒有什麼特別</span>
    </label>

    <label class="option runaway">
      <input type="radio" name="drink" value="later">
      <span>有點迷茫，不知道自己算什麼</span>
    </label>

    <label class="option runaway">
      <input type="radio" name="drink" value="dependsOnBrand">
      <span>可能還需要多一點自信</span>
    </label>
  </div>


  
</body>


</html>
